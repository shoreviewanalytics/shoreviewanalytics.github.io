<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.6 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Using Python To Transform and Clean a Data Set -</title>
<meta name="description" content="This post discusses how to use Python to transform and clean a data set into a data set that more easily consumed by Tableau or Power BI.">


  <meta name="author" content="CHAD DOWNEY, M.SC. IT">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="Using Python To Transform and Clean a Data Set">
<meta property="og:url" content="http://localhost:4000/Using-Python-To-Transform-A-Data-Set/">


  <meta property="og:description" content="This post discusses how to use Python to transform and clean a data set into a data set that more easily consumed by Tableau or Power BI.">







  <meta property="article:published_time" content="2019-11-18T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/Using-Python-To-Transform-A-Data-Set/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "shoreviewanalytics",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="googlef0fa90c52d6664f6" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <img src="/assets/images/logo.png" alt="Logo" width="260" height="214"> 
        <a class="site-title" href="http://localhost:4000/"></a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="https://github.com/shoreviewanalytics" >GitHub Repo</a>
            </li>
          
        </ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      

<div id="main" role="main">
  <article class="splash" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="datePublished" content="November 18, 2019">
    
    <section class="page__content" itemprop="text">
      
  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Using Python To Transform and Clean a Data Set</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">CHAD DOWNEY, M.SC. IT</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">USA</span>
        </li>
      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/chaddowney2019" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/shoreviewanalytics" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Using Python To Transform and Clean a Data Set">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="November 18, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Using Python To Transform and Clean a Data Set
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <hr />

<p>Often it is necessary to transform a data set from its original format to a format that is easier to work with data visualization software. For this post we demonstrate how to modify a readily available data set that contains GDP data as of 2018 into a data set that is more easily consumed by a data visualization tools such as Power BI or Tableau.</p>

<h2 id="prerequisites">Prerequisites:</h2>

<ol>
  <li>Python 3.x is needed and ideally you have a virtual install.</li>
  <li>Working install and knowledge of Jupyter Notebook, preferably to a virtual Python environment.</li>
  <li>Notepad++, use it to convert a file created on windows to ANSI or UTF-8</li>
  <li>Working knowledge of Python loops, lists, dictionaries, Pandas</li>
  <li>Ability to install additional Python libraries to virtual Python environment.</li>
</ol>

<h2 id="step-1">Step 1</h2>

<p>Navigate to the following web page.</p>

<p><a href="https://data.worldbank.org/indicator/NY.GDP.MKTP.CD">https://data.worldbank.org/indicator/NY.GDP.MKTP.CD</a></p>

<h2 id="step-2">Step 2</h2>

<p>Download the .xls file</p>

<p>If you open this file you will notice that the data points from 1960 to 2018 are pivoted across the workbook from left to right.  This is fine for reviewing the data but it is not a great format to consume using Tableau or Power BI.  In the steps below we will transform and clean this file so that it is in a format that can be more easily consumed by Tableau or Power BI.</p>

<h2 id="step-3">Step 3</h2>

<p>Copy the downloaded file to a new name called GDP 2018.xls.</p>

<h2 id="step-4">Step 4</h2>

<p>Open the file and perform a few clean up tasks.</p>

<p>a.  Remove the first three rows from the GDP 2018.xls file.  Next remove the two columns called “Indicator Name” and “Indicator Code”.</p>

<p>b.  Next select all the cells with numeric values, some cells will look like  “1.5343E+11” but this value is not very data visualization friendly. To convert to a regular numeric value select all the cells under the dates from 1960 to 2018 and then right click on the selected cells and choose Format Cells.  Change the data type to number using the default. <br />
c.  Once the preliminary clean up is done, copy the content of the excel sheet to a new excel workbook.<br />
d.  Select all the data cells that contain numbers and format as a number. 
d.  Save the new workbook as a .csv file “GDP 2018.csv”.  Note: It if the .csv is created with windows and your data transformation is done using Linux you may need to convert the GDP 2018.csv file from UTF-8 to ANSI.  You can use notepad++ to do the conversion.<br />
e.  Open the original data file and copy the Metadata - Countries to a new empty workbook and save the file as a .csv called “GDP 2018 metadata”.  This file will be used to merge with the data in the first .csv called “GDP 2018.csv”.</p>

<h2 id="step-5">Step 5</h2>

<p>Now it’s time to do the transformation of the data set.  Notice that the data set contains data from left to right with the column headings of 1960 to 2018.  This is great for reviewing data that has been collected but it doesn’t work well with with Tableau or Power BI which expect a data set / model that is dimensional in nature.  A complete discussion of dimensions and facts is outside the scope of the post to learn more see.</p>

<p>Open Jupyter Notebook and create a new notebook called “GDP 2018”.  Use the following code to connect to your .csv files.</p>

<p>a. Connect to the GDP 2018.csv</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opened_file = open('../data/GDP 2018.csv')
from csv import reader
read_file = reader(opened_file)
wb_gdp = list(read_file)
opened_file.close()
wb_gdp = wb_gdp[1:]
</code></pre></div></div>
<p>b. Connect to the GDP 2018 metadata.csv</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opened_file = open('../data/GDP 2018 metadata.csv')
from csv import reader
read_file = reader(opened_file)
wb_gdp_md = list(read_file)
opened_file.close()
wb_gdp_md = wb_gdp_md[1:]
</code></pre></div></div>
<p>c.  Use the following code to loop through each .csv created above and then write a new .csv called “GDP 2018 clean.csv”</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import pandas as pd

# create a years dictionary to loop through 

years = {1960:2,1961:3,1962:4,1963:5,1964:6,1965:7,1966:8,1967:9,1968:10,1969:11,1970:12,1971:13,1972:14, \
         1973:15,1974:16,1975:17,1976:18,1977:19,1978:20,1979:21,1980:22,1981:23,1982:24,1983:25,1984:26, \
         1985:27,1986:28,1987:29,1988:30,1989:31,1990:32,1991:33,1992:34,1993:35,1994:36,1995:37,1996:38,1997:39, \
         1998:40,1999:41,2000:42,2001:43,2002:44,2003:45,2004:46,2005:47,2006:48,2007:49,2008:50,2009:51,2010:52, \
         2011:53,2012:54,2013:55,2014:56,2015:55,2016:56,2017:57,2018:58}

records = []
record = []

for row in wb_gdp:
    
    country = row[0]    
    country = country.replace(",","")
    if country == "Gambia The":
        country = "Gambia"
        
    country_code = row[1] 
    
    region = ""
    income_group = ""
    
    # based on the country_code, fetch the region &amp; income group info
    
    for code in wb_gdp_md:
        if code[0] == country_code:
            region = code[1]
            income_group = code[2]


    
    for year in years:        
               
        #print(country_code+','+country+','+region+','+income_group+','+str(year)+','+str(row[years[year]]))
        
        record = [country_code,country,region,income_group,str(year),str(row[years[year]])]
        if records != "":
            records.append(record)


      
df = pd.DataFrame(records)

df.to_csv('../data/GDP 2018 clean.csv', sep=',',index=False,header=False)
</code></pre></div></div>

<h2 id="summary">Summary</h2>

<p>This is a really simple example of how to use Python to transform and clean a data set.  Rather than spending hours using another tool or technique to modify the originally downloaded data set so it is easily consumed by Tableau or Power BI, you have been able to transform over 15,000 records into a format that is more easily consumed by Tableau or Power BI in less than an hour using Python.  The next step is loading the data into Tableau or Power BI to create a data visualization. If you would like to use the cleaned data set you can find it <a href="../downloads/GDP 2018 clean.csv">here</a>.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-11-18T00:00:00-05:00">November 18, 2019</time></p>
        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Using+Python+To+Transform+and+Clean+a+Data+Set%20http%3A%2F%2Flocalhost%3A4000%2FUsing-Python-To-Transform-A-Data-Set%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FUsing-Python-To-Transform-A-Data-Set%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FUsing-Python-To-Transform-A-Data-Set%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/Spring-Kafka-Write-to-Cassandra/" class="pagination--pager" title="Spring Kafka Write to Cassandra
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/writing.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Spring-Kafka-Write-to-Cassandra/" rel="permalink">Spring Kafka Write to Cassandra
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/writing.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Getting-Started-With-Python3-And-PyCharm-On-Ubuntu-18.04/" rel="permalink">Getting Started with Python3 and PyCharm on Ubuntu 18.04
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/writing.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Gitlab-Fix-Runner-Registration-x509-Certification-Error/" rel="permalink">Gitlab Runner Registration x509 Certificate Error
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/writing.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Installing-Tomcat9-on-Ubuntu-18.04/" rel="permalink">Installing Tomcat 9 on Ubuntu 18.04
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </section>
  </article>
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
    
        <li><a href="https://www.linkedin.com/in/chaddowney2019"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
    
    
    
    
      <li><a href="https://github.com/shoreviewanalytics"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 shoreviewanalytics Powered by Me, <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>







    
  <script>
    (function ($) {
    $('#new_comment').submit(function () {
      var form = this;

      $(form).addClass('disabled');
      $('#comment-form-submit').html('<i class="fas fa-spinner fa-spin fa-fw"></i> Loading...');

      $.ajax({
        type: $(this).attr('method'),
        url: $(this).attr('action'),
        data: $(this).serialize(),
        contentType: 'application/x-www-form-urlencoded',
        success: function (data) {
          $('#comment-form-submit').html('Submitted');
          $('.page__comments-form .js-notice').removeClass('notice--danger');
          $('.page__comments-form .js-notice').addClass('notice--success');
          showAlert('Thanks for your comment! It will show on the site once it has been approved.');
        },
        error: function (err) {
          console.log(err);
          $('#comment-form-submit').html('Submit Comment');
          $('.page__comments-form .js-notice').removeClass('notice--success');
          $('.page__comments-form .js-notice').addClass('notice--danger');
          showAlert('Sorry, there was an error with your submission. Please make sure all required fields have been completed and try again.');
          $(form).removeClass('disabled');
        }
      });

      return false;
    });

    function showAlert(message) {
      $('.page__comments-form .js-notice').removeClass('hidden');
      $('.page__comments-form .js-notice-text').html(message);
    }
  })(jQuery);
  </script>


  





  </body>
</html>
